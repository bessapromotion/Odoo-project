<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <!--amélioration Filtre purchase -->
        <record id="view_picking_affectation_search" model="ir.ui.view">
          <field name="name">picking.expand2.filter</field>
          <field name="model">stock.picking</field>
          <field name="inherit_id" ref="stock.view_picking_internal_search"/>
          <field name="arch" type="xml">
            <xpath expr="//search" position="inside">
              <field name="demande_id" />
              <field name="project_id" />
            </xpath>
          </field>
        </record>

        <record id="action_stock_affectation" model="ir.actions.act_window">
            <field name="name">Affectation</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">stock.picking</field>
            <!--<field name="context">{'search_default_demande_id': [active_id], 'default_demande_id': active_id}</field>-->
            <field name="domain">[('mise_a_dispo','=','mad'))]</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="view_picking_affectation_search"/>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Cliquez pour créer une affectation.
              </p><p>
              </p>
            </field>
        </record>

        <record id="action_stock_affectation2" model="ir.actions.act_window">
            <field name="name">Affectation</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">stock.picking</field>
            <field name="context">{'search_default_demande_id': [active_id], 'default_demande_id': active_id}</field>
<!--            <field name="domain">[('mise_a_dispo','=', 'mad')]</field>-->
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="view_picking_affectation_search"/>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to create a picking.
              </p><p>
              </p>
            </field>
        </record>

        <record id="view_stock_affectation_form" model="ir.ui.view">
            <field name="name">stock.affectation.improv.form.inherit</field>
            <field name="model">stock.picking</field>
            <field name="priority">2</field>
            <field name="inherit_id" ref="stock.view_picking_form"/>
            <field name="arch" type="xml">
                <data>
                    <xpath expr="//field[@name='picking_type_id']" position="after">
                       <!--<field name="mise_a_dispo" />-->
                    </xpath>
                    <xpath expr="//field[@name='origin']" position="after">
<!--                        <field name="partner_id"/>-->
                        <field name="demande_id" attrs="{'invisible':[('mise_a_dispo', '!=', 'mad')]}"/>
                        <field name="project_id" attrs="{'invisible':[('demande_id', '=', False)]}" options="{'no_create': True}"/>
                        <field name="employe_id" attrs="{'invisible':[('mise_a_dispo', '!=', 'mad')]}"/>
                        <field name="department_id" attrs="{'invisible':[('mise_a_dispo', '!=', 'mad')]}"/>
                        <field name="job_id" attrs="{'invisible':[('mise_a_dispo', '!=', 'mad')]}"/>
                        <field name="mise_a_dispo" invisible="1"/>
                        <!--<field name="employe_id" attrs="{'invisible':[('mise_a_dispo', '!=', 'mad')]}"/>-->
                        <!--<field name="department_id" attrs="{'invisible':[('mise_a_dispo', '!=', 'mad')]}"/>-->
                    <!--    &lt;!&ndash;<field name="site_id"  domain="[('customer', '=', True)]" attrs="{'invisible':[('picking_type_id','!=',4)]}"/>&ndash;&gt;-->
                    </xpath>

                </data>
            </field>
        </record>

        <record id="view_stock_type_affectation_form" model="ir.ui.view">
            <field name="name">stock.type.affectation.improv.form.inherit</field>
            <field name="model">stock.picking.type</field>
            <field name="priority">2</field>
            <field name="inherit_id" ref="stock.view_picking_type_form"/>
            <field name="arch" type="xml">
                <data>
                    <xpath expr="//field[@name='code']" position="after">
                        <field name="mise_a_dispo" />
                    </xpath>
                </data>
            </field>
        </record>

    </data>
</openerp>
