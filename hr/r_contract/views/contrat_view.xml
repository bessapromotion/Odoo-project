<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <record id="view_dl_contract_form" model="ir.ui.view">
            <field name="name">dl.contract.form.inherit</field>
            <field name="model">hr.contract</field>
            <field name="priority">2</field>
            <field name="inherit_id" ref="hr_contract.hr_contract_view_form"/>
            <field name="arch" type="xml">
                <data>
                    <xpath expr="//field[@name='state']" position="after">
                        <button name="action_signer" string="Signer" states="draft" class="oe_highlight" type="object"
                                icon="fa-pencil"/>
                        <button name="action_print" string="Imprimer" class="oe_highlight" type="object"
                                icon="fa-print"/>
                    </xpath>
                    <xpath expr="//field[@name='department_id']" position="before">
                        <field name="company_id" readonly="1"/>
                    </xpath>
                    <xpath expr="//field[@name='employee_id']" position="before">
                        <field name="date_etablissement"/>
                    </xpath>
                    <xpath expr="//field[@name='structure_type_id']" position="attributes">
                        <attribute name="attrs">{'required': False}</attribute>
                    </xpath>
                    <xpath expr="//field[@name='hr_responsible_id']" position="attributes">
                        <attribute name="attrs">{'required': False}</attribute>
                    </xpath>
                    <xpath expr="//field[@name='hr_responsible_id']" position="after">
                        <field name="modele_id" options="{'no_create': True, 'no_open': True}"/>
                        <field name="type_id" options="{'no_create': True, 'no_open': True}" readonly="1" force_save="1"
                               invisible="1"/>
                    </xpath>
                    <xpath expr="//group[@name='top_info_right']" position="after">
                        <group>
                            <separator/>
                            <separator/>
                            <field name="user_id" options='{"no_open": True, "no_create": True}' readonly="1"/>
                            <field name="trial_state" string="Etat de la période d'essai"
                                   decoration-success="trial_state == 'open'"
                                   decoration-info="trial_state == 'renewed'"
                                   decoration-danger="trial_state == 'expired'"
                                   decoration-muted="trial_state == 'done'"
                                   widget="badge"/>
                        </group>
                    </xpath>
                    <xpath expr="//group[@name='notes_group']" position="before">
                        <group>
                            <field name="type_contract"/>
                        </group>
                        <group>

                            <group string='Conditions du contrat' name="duration_group">
                                <field name="first_contract_date"
                                       attrs="{'invisible': ['|', ('first_contract_date', '=', False), ('first_contract_date', '=', 'date_start')]}"
                                       invisible="1"/>

                                <field name="type_id_code" invisible="1"/>
                                <field name="duree_contrat" attrs="{'invisible':[('type_id_code', '=', 'CDI')]}"
                                       invisible="1"/>
                                <field name="calendar_mismatch" invisible="1"/>
                                <label for="resource_calendar_id"/>
                                <div>
                                    <field name="resource_calendar_id" required="1" nolabel="1"/>
                                    <span attrs="{'invisible': ['|', ('calendar_mismatch', '=', False), ('state', '!=', 'open')]}"
                                          class="fa fa-exclamation-triangle text-danger o_calendar_warning pl-3">
                                    </span>
                                    <span class="o_calendar_warning_tooltip text-danger">
                                        Calendar Mismatch : The employee's calendar does not match this contract's
                                        calendar. This could lead to unexpected behaviors.
                                    </span>
                                </div>
                                <label for="preavis"/>
                                <div class="o_row">
                                    <field name="preavis"/>
                                    <field name="uom_preavis"/>
                                </div>
                            </group>
                            <group string="Période d'essai" name="grp_essai">
                                <field name="trial_state" string="Etat de la période d\'essai"/>
                                <div class="o_row">
                                    <field name="trial_state"/>
                                    <field name="trial_date_start" widget="daterange"
                                           options='{"related_end_date": "trial_date_end"}'/>
                                    <i class="fa fa-long-arrow-right mx-2" aria-label="Arrow icon" title="Arrow"/>
                                    <field name="trial_date_end" widget="daterange"
                                           options='{"related_start_date": "trial_date_start"}'/>
                                </div>
                                <div class="o_row">
                                    <field name="trial_nbr_mois" style="text-align:right; width:auto;"/>
                                    <label for="trial_nbr_mois" string="mois et"/>
                                    <field name="trial_nbr_jours" style="text-align:right; width:auto;"/>
                                    <label for="trial_nbr_jours" string="jours"/>
                                    <field name="trial_state"/>
                                    <label for="trial_state" string="Etat de la période d'essai"/>
                                </div>
                            </group>

                        </group>
                    </xpath>
                    <!--                                        <xpath expr="//field[@name='trial_date_end']" position="replace"/>-->
                    <xpath expr="//field[@name='date_end']" position="before">
                        <field name="type_id_code" invisible="1"/>
                        <field name="nbr_mois" attrs="{'invisible':[('type_id_code', '=', 'CDI')]}"/>
                    </xpath>
                    <xpath expr="//group[@name='salary']" position="after">
                        <group string="Categorie/Section">
                            <field name="categorie"/>
                            <field name="section"/>
                        </group>
                    </xpath>
                    <xpath expr="//div[@name='wage']" position="after">
                        <field name="type_salaire"/>
                    </xpath>
                    <!-- Rubriques -->
                    <xpath expr="//group[@name='notes_group']" position="after">
                        <field name="rubrique_ids" invisible="1">
                            <tree editable="bottom">
                                <field name="name"/>
                            </tree>
                        </field>
                    </xpath>
                    <!-- Articles Page -->
                    <xpath expr="//page[@name='information']" position="after">
                        <page string="Articles du contrat" name="articles">

                            <group>
                                <field name="article_lines" force_save="1"
                                       nolabel="1">
                                    <tree>
                                        <field name="code"/>
                                        <field name="name"/>
                                    </tree>
                                </field>
                            </group>
                        </page>
                    </xpath>
                    <xpath expr="//field[@name='contract_type_id']" position="attributes">
                        <attribute name="options">{"no_create": True}</attribute>
                    </xpath>

                    <!-- Salaire  Page -->
                    <xpath expr="//page[@name='information']" position="attributes">
                        <attribute name="groups">hr.group_hr_manager,base.group_system,base.group_erp_manager
                        </attribute>
                    </xpath>

                </data>
            </field>
        </record>

        <record id="view_dl_contract_tree" model="ir.ui.view">
            <field name="name">dl.contract.tree.inherit</field>
            <field name="model">hr.contract</field>
            <field name="priority">2</field>
            <field name="inherit_id" ref="hr_contract.hr_contract_view_tree"/>
            <field name="arch" type="xml">
                <data>
                    <xpath expr="//field[@name='resource_calendar_id']" position="replace"/>
                </data>
            </field>
        </record>

        <record id="view_dl_contract_kanban" model="ir.ui.view">
            <field name="name">dl.contract.kanban.inherit</field>
            <field name="model">hr.contract</field>
            <field name="priority">2</field>
            <field name="inherit_id" ref="hr_contract.hr_contract_view_kanban"/>
            <field name="arch" type="xml">
                <data>
                    <xpath expr="//field[@name='job_id']" position="replace">
                    </xpath>
                    <xpath expr="//strong[@class='o_kanban_record_title']" position="inside">
                        <div>
                            <field name="employee_id"/>
                        </div>
                        <field name="job_id"/>
                        <div>
                            <field name="department_id"/>
                        </div>
                    </xpath>
                </data>
            </field>
        </record>

        <!--        regime de travail-->

        <!-- Groupe de menu Contrat -->
        <!-- <menuitem name="Contrat" id="menu_group_contrat" parent="hr_base.menu_operations" sequence="90"/> -->
        <menuitem name="Contrat" id="menu_group_contrat" parent="hr.menu_human_resources_configuration" sequence="100"
                  groups="hr_contract.group_hr_contract_manager"/>

    </data>
</openerp>
